(window.webpackJsonp=window.webpackJsonp||[]).push([[115],{248:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return d})),n.d(t,"rightToc",(function(){return O})),n.d(t,"default",(function(){return p}));var l=n(1),a=n(9),b=(n(0),n(262)),i=n(263),c=n(274),r=n(273),u=n(265),o={id:"tutorial-03",title:"Tutorial 3: Applications with Multiple Screens"},d={id:"tutorials/tutorial-03",title:"Tutorial 3: Applications with Multiple Screens",description:"import Figure from '@site/components/Figure';",source:"@site/docs\\tutorials\\tutorial-03.mdx",permalink:"/docs/tutorials/tutorial-03",sidebar:"docs",previous:{title:"Tutorial 2: Creating Your Own Application",permalink:"/docs/tutorials/tutorial-02"},next:{title:"Tutorial 4: Creating a Scroll Wheel with Custom Behavior",permalink:"/docs/tutorials/tutorial-04"}},O=[{value:"Step 1: Setting up the Two Screens",id:"step-1-setting-up-the-two-screens",children:[{value:"Setting up Screen1",id:"setting-up-screen1",children:[]},{value:"Setting up Screen2",id:"setting-up-screen2",children:[]},{value:"Switching between Screens",id:"switching-between-screens",children:[]}]},{value:"Step 2: Saving Data",id:"step-2-saving-data",children:[{value:"Adding Hour and Minute to the Model",id:"adding-hour-and-minute-to-the-model",children:[]},{value:"Accessing the Model from the View",id:"accessing-the-model-from-the-view",children:[]},{value:"Data from the Model",id:"data-from-the-model",children:[]}]}],j={rightToc:O},s="wrapper";function p(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(b.b)(s,Object(l.a)({},j,n,{components:t,mdxType:"MDXLayout"}),Object(b.b)("p",null,"In this tutorial, you will learn how to create multiple screens in an application and share data between the two screens. We will create an application that simulates a clock, which will use one screen to set hour and minute and pass the time to another screen which has a running clock."),Object(b.b)("p",null,"You will also learn how to use the TouchGFX Designer to create animations based on interaction such as screen changes."),Object(b.b)("p",null,"The images we will use in this tutorial can be downloaded from this ",Object(b.b)("a",Object(l.a)({parentName:"p"},{href:"/download/tutorials/tutorial-03/touchgfx-tutorial-03.zip"}),"link"),". Unzip the file to a directory on your disk."),Object(b.b)("h2",{id:"step-1-setting-up-the-two-screens"},"Step 1: Setting up the Two Screens"),Object(b.b)("p",null,'Create a new project just as was done in tutorial 2. Again the graphics is designed for a resoultion of 480x272. If you base the project on the Application Template for the "STM32F746G Discovery Kit", your project will have this resolution. If you have a demo board with a different resolution you should" be able to modify the graphics to match it yourself. If you have no demo board simply base it on the "Simulator" Application Template and make sure to enter 480x272 as the resolution.'),Object(b.b)("h3",{id:"setting-up-screen1"},"Setting up Screen1"),Object(b.b)("p",null,"The first screen to create is Screen1, which is the screen where the hour and minute values can be set and sent to the screen with the running clock. Screen1 is shown below and contains two text boxes which contain the desired time for the clock. To adjust the value in the boxes the up and down arrows is used. For saving the selected values and thereby pass them on to the clock the save button below the respective boxes is used. Lastly switching to the Screen2 with the clock is done by pressing the Clock button."),Object(b.b)("p",null,"Let us start out by inserting the background and the text areas for our application. Insert the widgets and update the properties as listed in the picture and table below."),Object(b.b)(i.a,{imageSource:"/img/tutorials/tutorial-03/screen1-screenshot.png",caption:"Screenshot of screen1 with the location of the background and the text areas highlighted",mdxType:"Figure"}),Object(b.b)("table",null,Object(b.b)("thead",{parentName:"table"},Object(b.b)("tr",{parentName:"thead"},Object(b.b)("th",Object(l.a)({parentName:"tr"},{align:null}),"Location"),Object(b.b)("th",Object(l.a)({parentName:"tr"},{align:null}),"Widget"),Object(b.b)("th",Object(l.a)({parentName:"tr"},{align:null}),"Properties"))),Object(b.b)("tbody",{parentName:"table"},Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"1"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"Image"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),Object(b.b)("ul",null,Object(b.b)("li",null,"Name: background"),Object(b.b)("li",null,"Location:",Object(b.b)("ul",null,Object(b.b)("li",null,"X: 0, Y: 0"))),Object(b.b)("li",null,"Image:background_Screen1.png")))),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"2"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"TextArea"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),Object(b.b)("ul",null,Object(b.b)("li",null,"Name: textAreaHourCaption"),Object(b.b)("li",null,"Location:",Object(b.b)("ul",null,Object(b.b)("li",null,"X: 86, Y: 46"),Object(b.b)("li",null,"W: 85, H: 24"))),Object(b.b)("li",null,"Text:",Object(b.b)("ul",null,Object(b.b)("li",null,"Text: Hour"),Object(b.b)("li",null,"Typography: 20px"),Object(b.b)("li",null,"Alignment: Center"))),Object(b.b)("li",null,"Appearance:",Object(b.b)("ul",null,Object(b.b)("li",null,"Color: #FFABABAB")))))),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"3"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"TextArea"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),Object(b.b)("ul",null,Object(b.b)("li",null,"Name: textAreaHour"),Object(b.b)("li",null,"Location:",Object(b.b)("ul",null,Object(b.b)("li",null,"X: 87, Y: 70"),Object(b.b)("li",null,"W: 83, H: 50"))),Object(b.b)("li",null,"Text:",Object(b.b)("ul",null,Object(b.b)("li",null,"Text: ","<","value",">"),Object(b.b)("li",null,"Wildcard 1:",Object(b.b)("ul",null,Object(b.b)("li",null,"Initial Value: 00"),Object(b.b)("li",null,"Buffer size: 3"))),Object(b.b)("li",null,"Typography: 40px"),Object(b.b)("li",null,"Alignment: Center"))),Object(b.b)("li",null,"Appearance:",Object(b.b)("ul",null,Object(b.b)("li",null,"Color: #FFABABAB")))))),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"4"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"TextArea"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),Object(b.b)("ul",null,Object(b.b)("li",null,"Name: textAreaMinuteCaption"),Object(b.b)("li",null,"Location:",Object(b.b)("ul",null,Object(b.b)("li",null,"X: 309, Y: 46"),Object(b.b)("li",null,"W: 85, H: 24"))),Object(b.b)("li",null,"Text:",Object(b.b)("ul",null,Object(b.b)("li",null,"Text: Minute"),Object(b.b)("li",null,"Typography: 20px"),Object(b.b)("li",null,"Alignment: Center"))),Object(b.b)("li",null,"Appearance:",Object(b.b)("ul",null,Object(b.b)("li",null,"Color: #FFABABAB")))))),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"5"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"TextArea"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),Object(b.b)("ul",null,Object(b.b)("li",null,"Name: textAreaMinute"),Object(b.b)("li",null,"Location:",Object(b.b)("ul",null,Object(b.b)("li",null,"X: 311, Y: 70"),Object(b.b)("li",null,"W: 83, H: 50"))),Object(b.b)("li",null,"Text:",Object(b.b)("ul",null,Object(b.b)("li",null,"Text: ","<","value",">"),Object(b.b)("li",null,"Wildcard 1:",Object(b.b)("ul",null,Object(b.b)("li",null,"Initial Value: 00"),Object(b.b)("li",null,"Buffer size: 3"))),Object(b.b)("li",null,"Typography: 40px"),Object(b.b)("li",null,"Alignment: Center"))),Object(b.b)("li",null,"Appearance:",Object(b.b)("ul",null,Object(b.b)("li",null,"Color: #FFABABAB")))))))),Object(b.b)("p",null,"Then insert the buttons to the application as shown in the picture and table below."),Object(b.b)(i.a,{imageSource:"/img/tutorials/tutorial-03/screen1-screenshot-02.png",caption:"Screenshot of screen 1 with the location of the buttons highlighted",mdxType:"Figure"}),Object(b.b)("table",null,Object(b.b)("thead",{parentName:"table"},Object(b.b)("tr",{parentName:"thead"},Object(b.b)("th",Object(l.a)({parentName:"tr"},{align:null}),"Location"),Object(b.b)("th",Object(l.a)({parentName:"tr"},{align:null}),"Widget"),Object(b.b)("th",Object(l.a)({parentName:"tr"},{align:null}),"Properties"))),Object(b.b)("tbody",{parentName:"table"},Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"1"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"Button"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),Object(b.b)("ul",null,Object(b.b)("li",null,"Name: buttonHourUp"),Object(b.b)("li",null,"Location:",Object(b.b)("ul",null,Object(b.b)("li",null,"X: 184, Y: 51"))),Object(b.b)("li",null,"Image:",Object(b.b)("ul",null,Object(b.b)("li",null,"Released Image: Up_arrow.png"),Object(b.b)("li",null,"Pressed Image: Up_arrow_pressed.png")))))),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"2"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"Button"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),Object(b.b)("ul",null,Object(b.b)("li",null,"Name: buttonHourDown"),Object(b.b)("li",null,"Location:",Object(b.b)("ul",null,Object(b.b)("li",null,"X: 184, Y: 93"))),Object(b.b)("li",null,"Image:",Object(b.b)("ul",null,Object(b.b)("li",null,"Released Image: Down_arrow.png"),Object(b.b)("li",null,"Pressed Image: Down_arrow_pressed.png")))))),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"3"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"Button"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),Object(b.b)("ul",null,Object(b.b)("li",null,"Name: buttonMinuteUp"),Object(b.b)("li",null,"Location:",Object(b.b)("ul",null,Object(b.b)("li",null,"X: 266, Y: 51"))),Object(b.b)("li",null,"Image:",Object(b.b)("ul",null,Object(b.b)("li",null,"Released Image: Up_arrow.png"),Object(b.b)("li",null,"Pressed Image: Up_arrow_pressed.png")))))),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"4"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"Button"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),Object(b.b)("ul",null,Object(b.b)("li",null,"Name: buttonMinuteDown"),Object(b.b)("li",null,"Location:",Object(b.b)("ul",null,Object(b.b)("li",null,"X: 266, Y: 93"))),Object(b.b)("li",null,"Image:",Object(b.b)("ul",null,Object(b.b)("li",null,"Released Image: Down_arrow.png"),Object(b.b)("li",null,"Pressed Image: Down_arrow_pressed.png")))))),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"5"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"Button With Label"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),Object(b.b)("ul",null,Object(b.b)("li",null,"Name: buttonSaveHour"),Object(b.b)("li",null,"Location:",Object(b.b)("ul",null,Object(b.b)("li",null,"X: 80, Y: 137"))),Object(b.b)("li",null,"Text:",Object(b.b)("ul",null,Object(b.b)("li",null,"Text: Save"),Object(b.b)("li",null,"Typography: 25px"),Object(b.b)("li",null,"Alignment: Center"))),Object(b.b)("li",null,"Text Appearance:",Object(b.b)("ul",null,Object(b.b)("li",null,"Released Color: #FF424242"),Object(b.b)("li",null,"Pressed Color: #FFA6A6A6"))),Object(b.b)("li",null,"Image:",Object(b.b)("ul",null,Object(b.b)("li",null,"Released Image: btn_round.png"),Object(b.b)("li",null,"Pressed Image: btn_round_pressed.png")))))),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"6"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"Button With Label"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),Object(b.b)("ul",null,Object(b.b)("li",null,"Name: buttonSaveMinute"),Object(b.b)("li",null,"Location:",Object(b.b)("ul",null,Object(b.b)("li",null,"X: 303, Y: 137"))),Object(b.b)("li",null,"Text:",Object(b.b)("ul",null,Object(b.b)("li",null,"Text: Save"),Object(b.b)("li",null,"Typography: 25px"),Object(b.b)("li",null,"Alignment: Center"))),Object(b.b)("li",null,"Text Appearance:",Object(b.b)("ul",null,Object(b.b)("li",null,"Released Color: #FF424242"),Object(b.b)("li",null,"Pressed Color: #FFA6A6A6"))),Object(b.b)("li",null,"Image:",Object(b.b)("ul",null,Object(b.b)("li",null,"Released Image: btn_round.png"),Object(b.b)("li",null,"Pressed Image: btn_round_pressed.png")))))),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"7"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"Button With Label"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),Object(b.b)("ul",null,Object(b.b)("li",null,"Name: buttonClock"),Object(b.b)("li",null,"Location:",Object(b.b)("ul",null,Object(b.b)("li",null,"X: 192, Y: 204"))),Object(b.b)("li",null,"Text:",Object(b.b)("ul",null,Object(b.b)("li",null,"Text: Clock"),Object(b.b)("li",null,"Typography: 25px"),Object(b.b)("li",null,"Alignment: Center"))),Object(b.b)("li",null,"Text Appearance:",Object(b.b)("ul",null,Object(b.b)("li",null,"Released Color: #FF424242"),Object(b.b)("li",null,"Pressed Color: #FFA6A6A6"))),Object(b.b)("li",null,"Image:",Object(b.b)("ul",null,Object(b.b)("li",null,"Released Image: btn_round.png"),Object(b.b)("li",null,"Pressed Image: btn_round_pressed.png")))))))),Object(b.b)("p",null,"With the graphical elements set up next step is to add the triggers for the buttons, which adjust the selected values and saves them:"),Object(b.b)("table",null,Object(b.b)("thead",{parentName:"table"},Object(b.b)("tr",{parentName:"thead"},Object(b.b)("th",Object(l.a)({parentName:"tr"},{align:null}),"Interaction"),Object(b.b)("th",Object(l.a)({parentName:"tr"},{align:null}),"Properties"))),Object(b.b)("tbody",{parentName:"table"},Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"Hour up button is clicked"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),Object(b.b)("ul",null,Object(b.b)("li",null,"Trigger: Button is clicked"),Object(b.b)("li",null,"Clicked Source: buttonHourUp"),Object(b.b)("li",null,"Action: Call new virtual function"),Object(b.b)("li",null,"Function Name: buttonHourUpClicked")))),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"Hour down button is clicked"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),Object(b.b)("ul",null,Object(b.b)("li",null,"Trigger: Button is clicked"),Object(b.b)("li",null,"Clicked Source: buttonHourDown"),Object(b.b)("li",null,"Action: Call new virtual function"),Object(b.b)("li",null,"Function Name: buttonHourDownClicked")))),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"Minute up button is clicked"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),Object(b.b)("ul",null,Object(b.b)("li",null,"Trigger: Button is clicked"),Object(b.b)("li",null,"Clicked Source: buttonMinuteUp"),Object(b.b)("li",null,"Action: Call new virtual function"),Object(b.b)("li",null,"Function Name: buttonMinuteUpClicked")))),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"Minute down button is clicked"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),Object(b.b)("ul",null,Object(b.b)("li",null,"Trigger: Button is clicked"),Object(b.b)("li",null,"Clicked Source: buttonMinuteDown"),Object(b.b)("li",null,"Action: Call new virtual function"),Object(b.b)("li",null,"Function Name: buttonMinuteDownClicked")))),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"Save Hour button is clicked"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),Object(b.b)("ul",null,Object(b.b)("li",null,"Trigger: Button is clicked"),Object(b.b)("li",null,"Clicked Source: buttonSaveHour"),Object(b.b)("li",null,"Action: Call new virtual function"),Object(b.b)("li",null,"Function Name: buttonSaveHourClicked")))),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"Save Minute button is clicked"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),Object(b.b)("ul",null,Object(b.b)("li",null,"Trigger: Button is clicked"),Object(b.b)("li",null,"Clicked Source: buttonSaveMinute"),Object(b.b)("li",null,"Action: Call new virtual function"),Object(b.b)("li",null,"Function Name: buttonSaveMinuteClicked")))))),Object(b.b)("p",null,'If you press "Generate Code" or "Run Simulator" the specified virtual functions will be generated by the Designer. Let us start by integrating the four functions for the arrow buttons. To keep track of the values for hour and minute, two counters are also added.'),Object(b.b)("p",null,"Now add the following code:"),Object(b.b)(c.a,{mdxType:"CodeHeader"},"Screen1View.hpp"),Object(b.b)("pre",null,Object(b.b)("code",Object(l.a)({parentName:"pre"},{className:"language-cpp"}),"...\npublic:\n...\n    virtual void buttonHourUpClicked();\n    virtual void buttonHourDownClicked();\n    virtual void buttonMinuteUpClicked();\n    virtual void buttonMinuteDownClicked();\n\nprotected:\n    int16_t hour;\n    int16_t minute;\n...\n")),Object(b.b)("p",null,"When pressing the arrows the corresponding value changes to fit within the values for a clock."),Object(b.b)("p",null,"The logic for the four functions should be added in the following way:"),Object(b.b)(c.a,{mdxType:"CodeHeader"},"Screen1View.cpp"),Object(b.b)("pre",null,Object(b.b)("code",Object(l.a)({parentName:"pre"},{className:"language-cpp"}),'...\nvoid Screen1View::buttonHourUpClicked()\n{\n    hour = (hour + 1) % 24; // Keep new value in range 0..23\n    Unicode::snprintf(textAreaHourBuffer, TEXTAREAHOUR_SIZE, "%02d", hour);\n    textAreaHour.invalidate();\n}\n\nvoid Screen1View::buttonHourDownClicked()\n{\n    hour = (hour + 24 - 1) % 24; // Keep new value in range 0..23\n    Unicode::snprintf(textAreaHourBuffer, TEXTAREAHOUR_SIZE, "%02d", hour);\n    textAreaHour.invalidate();\n}\n\nvoid Screen1View::buttonMinuteUpClicked()\n{\n    minute = (minute + 1) % 60; // Keep new value in range 0..59\n    Unicode::snprintf(textAreaMinuteBuffer, TEXTAREAMINUTE_SIZE, "%02d", minute);\n    textAreaMinute.invalidate();\n}\n\nvoid Screen1View::buttonMinuteDownClicked()\n{\n    minute = (minute + 60 - 1) % 60; // Keep new value in range 0..59\n    Unicode::snprintf(textAreaMinuteBuffer, TEXTAREAMINUTE_SIZE, "%02d", minute);\n    textAreaMinute.invalidate();\n}\n')),Object(b.b)("h3",{id:"setting-up-screen2"},"Setting up Screen2"),Object(b.b)("p",null,"The second screen, Screen2, is where the running clock is placed, starting from the values saved in Screen1. Other than the clock Screen2 also consist off a circle animating around the clock, indicating that the clock is running. Finally to return to Screen1 a button is implemented which changes the screen to Screen1."),Object(b.b)(i.a,{imageSource:"/img/tutorials/tutorial-03/screen2-screenshot.png",caption:"Screenshot of screen2 when running the application with the simulator",mdxType:"Figure"}),Object(b.b)("p",null,"Before adding elements to Screen2, a new screen has to be created. This is done with the add screen button in the TouchGFX Designer illustrated in the picture below."),Object(b.b)(i.a,{imageSource:"/img/tutorials/tutorial-03/add-screen.png",caption:"The location of the add screen button in the TouchGFX Designer",mdxType:"Figure"}),Object(b.b)("p",null,'When entering "screen2", both the clock and the circle animates into their position, by moving into view, with the clock moving in from the left and the circle from the right. The two widgets are therefore initially placed outside the canvas in the TouchGFX Designer.'),Object(b.b)("p",null,"The placement of the widgets should be done as in the picture and table below."),Object(b.b)(i.a,{imageSource:"/img/tutorials/tutorial-03/screen2-location-of-widgets.png",caption:"The loaction of the Wigets in screen2",mdxType:"Figure"}),Object(b.b)("table",null,Object(b.b)("thead",{parentName:"table"},Object(b.b)("tr",{parentName:"thead"},Object(b.b)("th",Object(l.a)({parentName:"tr"},{align:null}),"Location"),Object(b.b)("th",Object(l.a)({parentName:"tr"},{align:null}),"Widget"),Object(b.b)("th",Object(l.a)({parentName:"tr"},{align:null}),"Properties"))),Object(b.b)("tbody",{parentName:"table"},Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"1"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"Image"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),Object(b.b)("ul",null,Object(b.b)("li",null,"Name: background"),Object(b.b)("li",null,"Location:",Object(b.b)("ul",null,Object(b.b)("li",null,"X: 0, Y: 0"))),Object(b.b)("li",null,"Image:background_Screen2.png")))),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"1"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"Button"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),Object(b.b)("ul",null,Object(b.b)("li",null,"Name: buttonSettings"),Object(b.b)("li",null,"Location:",Object(b.b)("ul",null,Object(b.b)("li",null,"X: 422, Y: 10"))),Object(b.b)("li",null,"Image:",Object(b.b)("ul",null,Object(b.b)("li",null,"Released Image: configuration.png"),Object(b.b)("li",null,"Pressed Image: configuration.png")))))),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"3"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"TextArea"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),Object(b.b)("ul",null,Object(b.b)("li",null,"Name: textClock"),Object(b.b)("li",null,"Location:",Object(b.b)("ul",null,Object(b.b)("li",null,"X: -156, Y: 109"),Object(b.b)("li",null,"W: 156, H: 54"))),Object(b.b)("li",null,"Text:",Object(b.b)("ul",null,Object(b.b)("li",null,"Text: ","<","hour",">",":","<","min",">"),Object(b.b)("li",null,"Wildcard 1:",Object(b.b)("ul",null,Object(b.b)("li",null,"Initial Value: 00"),Object(b.b)("li",null,"Buffer size: 3"))),Object(b.b)("li",null,"Wildcard 2:",Object(b.b)("ul",null,Object(b.b)("li",null,"Initial Value: 00"),Object(b.b)("li",null,"Buffer size: 3"))),Object(b.b)("li",null,"Typography: 40px"),Object(b.b)("li",null,"Alignment: Center"))),Object(b.b)("li",null,"Appearance:",Object(b.b)("ul",null,Object(b.b)("li",null,"Color: #FFABABAB")))))),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"4"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"Circle"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),Object(b.b)("ul",null,Object(b.b)("li",null,"Name: circle"),Object(b.b)("li",null,"Location:",Object(b.b)("ul",null,Object(b.b)("li",null,"X: 479, Y: 36"),Object(b.b)("li",null,"W: 200, H: 200"))),Object(b.b)("li",null,"Image & Color:",Object(b.b)("ul",null,Object(b.b)("li",null,"Color: #FFBABABA"))),Object(b.b)("li",null,"Appearance:",Object(b.b)("ul",null,Object(b.b)("li",null,"Center Position:",Object(b.b)("ul",null,Object(b.b)("li",null,"X: 100, Y: 100"))),Object(b.b)("li",null,"Start & End Angle:",Object(b.b)("ul",null,Object(b.b)("li",null,"Start: 0, End: 180"))),Object(b.b)("li",null,"Radius: 72"),Object(b.b)("li",null,"Line Width: 6"),Object(b.b)("li",null,"Cap Style: Triangle")))))))),Object(b.b)("h3",{id:"switching-between-screens"},"Switching between Screens"),Object(b.b)("p",null,"Now we need to add functionality to switch between the two screens. For this we assign interactinos to the Clock button on Screen1 and the Configuration button on Screen2. Also, we want the two elements that are placed outside the screen area on Screen2 to move into place when Screen2 is entered."),Object(b.b)("p",null,"To do this add the following interaction to Screen1:"),Object(b.b)("table",null,Object(b.b)("thead",{parentName:"table"},Object(b.b)("tr",{parentName:"thead"},Object(b.b)("th",Object(l.a)({parentName:"tr"},{align:null}),"Interaction"),Object(b.b)("th",Object(l.a)({parentName:"tr"},{align:null}),"Properties"))),Object(b.b)("tbody",{parentName:"table"},Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),'Change to "Screen2"'),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),Object(b.b)("ul",null,Object(b.b)("li",null,"Trigger: Button is clicked"),Object(b.b)("li",null,"Clicked Source: buttonClock"),Object(b.b)("li",null,"Action: Change screen"),Object(b.b)("li",null,"Screen: Screen2"),Object(b.b)("li",null,"Transition: Cover"),Object(b.b)("li",null,"Transition Direction: North")))))),Object(b.b)("p",null,"Also add the following interaction to Screen2:"),Object(b.b)("table",null,Object(b.b)("thead",{parentName:"table"},Object(b.b)("tr",{parentName:"thead"},Object(b.b)("th",Object(l.a)({parentName:"tr"},{align:null}),"Interaction"),Object(b.b)("th",Object(l.a)({parentName:"tr"},{align:null}),"Properties"))),Object(b.b)("tbody",{parentName:"table"},Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),'Change to "Screen1"'),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),Object(b.b)("ul",null,Object(b.b)("li",null,"Trigger: Button is clicked"),Object(b.b)("li",null,"Clicked Source: buttonSettings"),Object(b.b)("li",null,"Action: Change screen"),Object(b.b)("li",null,"Screen: Screen1"),Object(b.b)("li",null,"Transition: Slide"),Object(b.b)("li",null,"Transition Direction: South")))),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"Move circle into place"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),Object(b.b)("ul",null,Object(b.b)("li",null,"Trigger: Screen is entered"),Object(b.b)("li",null,"Action: Move widget"),Object(b.b)("li",null,"Widget to move: circle"),Object(b.b)("li",null,"Position: 140, 36"),Object(b.b)("li",null,"Easing: Cubic, Out"),Object(b.b)("li",null,"Duration: 750ms")))),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),"Move text clock into place"),Object(b.b)("td",Object(l.a)({parentName:"tr"},{align:null}),Object(b.b)("ul",null,Object(b.b)("li",null,"Trigger: Screen is entered"),Object(b.b)("li",null,"Action: Move widget"),Object(b.b)("li",null,"Widget to move: textClock"),Object(b.b)("li",null,"Position: 162, 109"),Object(b.b)("li",null,"Easing: Cubic, Out"),Object(b.b)("li",null,"Duration: 750ms")))))),Object(b.b)("p",null,"To update the clock and animate the circle at runtime the virtual function ",Object(b.b)("inlineCode",{parentName:"p"},"handleTickEvent")," is used."),Object(b.b)("p",null,Object(b.b)("inlineCode",{parentName:"p"},"handleTickEvent")," is called periodically by the TouchGFX framework enabling it to update elements in the active screen dynamically, which in this case will be the clock and circle."),Object(b.b)("p",null,"Similar to Screen1 an hour and a minute counter is used to keep track of the clock. Since ",Object(b.b)("inlineCode",{parentName:"p"},"handleTickEvent")," is called more frequently than the clock should be updated, a tickCounter is added to determine the number of ticks between the clock updates. For updating the angle of the arc in the circle the functions addStart and addEnd are used. The ",Object(b.b)("inlineCode",{parentName:"p"},"handleTickEvent")," function and the variables are added as shown to Screen2View.hpp as shown below."),Object(b.b)(c.a,{mdxType:"CodeHeader"},"Screen2View.hpp"),Object(b.b)("pre",null,Object(b.b)("code",Object(l.a)({parentName:"pre"},{className:"language-cpp"}),"public:\n...\n    virtual void handleTickEvent();\n\nprotected:\n    int16_t hour;\n    int16_t minute;\n    int16_t tickCount;\n    int16_t addStart;\n    int16_t addEnd;\n...\n")),Object(b.b)("p",null,"The implementation of ",Object(b.b)("inlineCode",{parentName:"p"},"handleTickEvent")," in ",Object(b.b)("inlineCode",{parentName:"p"},"Screen2View.cpp"),", thereby, the code which updates the clock and the circle is shown below"),Object(b.b)(c.a,{mdxType:"CodeHeader"},"Screen2View.cpp"),Object(b.b)("pre",null,Object(b.b)("code",Object(l.a)({parentName:"pre"},{className:"language-cpp"}),'...\nvoid Screen2View::handleTickEvent()\n{\n    if (tickCount == 60)\n    {\n        minute++;\n        hour = (hour + (minute / 60)) % 24;\n        minute %= 60;\n\n        Unicode::snprintf(textClockBuffer1, TEXTCLOCKBUFFER1_SIZE, "%02d", hour);\n        Unicode::snprintf(textClockBuffer2, TEXTCLOCKBUFFER2_SIZE, "%02d", minute);\n\n        textClock.invalidate();\n\n        tickCount = 0;\n    }\n\n    if (!textClock.isMoveAnimationRunning())\n    {\n        tickCount++;\n        if (circle.getArcStart() + 340 == circle.getArcEnd())\n        {\n            addStart = 2;\n            addEnd = 1;\n        }\n        else if (circle.getArcStart() + 20 == circle.getArcEnd())\n        {\n            addStart = 1;\n            addEnd = 2;\n        }\n        circle.invalidate();\n        circle.setArc(circle.getArcStart() + addStart, circle.getArcEnd() + addEnd);\n        circle.invalidate();\n    }\n}\n...\n')),Object(b.b)("p",null,'As learned in tutorial 2 we need to add the characters used in the wildcards. In this case you need to add "0-9" in the column ',Object(b.b)("em",{parentName:"p"},"Wildcard Ranges")," for the typography used for the TextAreas."),Object(b.b)(r.a,{mdxType:"FurtherReading"},"In this step the widget Circle has been used. Read more about the Circle widget on the ",Object(b.b)(u.a,{to:"/docs/development/ui-development/ui-components/shapes/circle",mdxType:"Link"},"Circle")," page."),Object(b.b)("h2",{id:"step-2-saving-data"},"Step 2: Saving Data"),Object(b.b)("p",null,"In this step, we will show how to save data when switching between screens and how to retrieve the saved data."),Object(b.b)("p",null,"TouchGFX applications follows the Model-View-Presenter design pattern, so in order to persist data manipulated in a view (i.e. a Screen), the data should be sent to the model (through a presenter). More information on the Model-View-Presenter design pattern can be found on the ",Object(b.b)("a",Object(l.a)({parentName:"p"},{href:"/docs/development/ui-development/software-architecture/model-view-presenter-design-pattern"}),"Model-View-Presenter Design Pattern")," page."),Object(b.b)("h3",{id:"adding-hour-and-minute-to-the-model"},"Adding Hour and Minute to the Model"),Object(b.b)("p",null,"The model is responsible for holding data for the application. Temporary data, such as button states, currently visible widget etc. should not be in the model."),Object(b.b)("p",null,"To save and retrieve data via the model, add protected hour and minute values to the model, as well as public functions to access these values:"),Object(b.b)(c.a,{mdxType:"CodeHeader"},"Model.hpp"),Object(b.b)("pre",null,Object(b.b)("code",Object(l.a)({parentName:"pre"},{className:"language-cpp"}),"...\npublic:\n    void saveHour(int16_t saveHour)\n    {\n        hour = saveHour;\n    }\n\n    void saveMinute(int16_t saveMinute)\n    {\n        minute = saveMinute;\n    }\n\n    int16_t getHour()\n    {\n        return hour;\n    }\n\n    int16_t getMinute()\n    {\n        return minute;\n    }\n\nprotected:\n    int16_t hour;\n    int16_t minute;\n...\n")),Object(b.b)("p",null,"Make sure to initialize hour and minute in the constructor:"),Object(b.b)(c.a,{mdxType:"CodeHeader"},"Model.cpp"),Object(b.b)("pre",null,Object(b.b)("code",Object(l.a)({parentName:"pre"},{className:"language-cpp"}),"...\nModel::Model() : modelListener(0), hour(0), minute(0)\n{\n}\n...\n")),Object(b.b)("p",null,"With this code, the hour and minute have a place in the model. Since the model is available to all presenters, this the recommended way to share information between presenters (and views). The model is also where the UI is able to connect to the rest of the system, such as hardware peripherals and other software modules."),Object(b.b)("h3",{id:"accessing-the-model-from-the-view"},"Accessing the Model from the View"),Object(b.b)("p",null,"Now, in order to access the data in the model from the view, the presenter should provide functions to allow ",Object(b.b)("inlineCode",{parentName:"p"},"Screen1View")," to load and save the data from the model as follows:"),Object(b.b)(c.a,{mdxType:"CodeHeader"},"Screen1Presenter.hpp"),Object(b.b)("pre",null,Object(b.b)("code",Object(l.a)({parentName:"pre"},{className:"language-cpp"}),"...\npublic:\n    void saveHour(int16_t hour)\n    {\n        model->saveHour(hour);\n    }\n\n    void saveMinute(int16_t minute)\n    {\n        model->saveMinute(minute);\n    }\n\n    int16_t getHour()\n    {\n        return model->getHour();\n    }\n\n    int16_t getMinute()\n    {\n        return model->getMinute();\n    }\n...\n")),Object(b.b)("p",null,"Since Screen2 should also be able to access the data in the model, add the same lines to ",Object(b.b)("inlineCode",{parentName:"p"},"Screen2Presenter.hpp"),"."),Object(b.b)("h3",{id:"data-from-the-model"},"Data from the Model"),Object(b.b)("p",null,"The code to access hour and minute in the Model is now in place, and ",Object(b.b)("inlineCode",{parentName:"p"},"Screen1")," and ",Object(b.b)("inlineCode",{parentName:"p"},"Screen2")," should be updated to get these values from the Model instead of using local variables only."),Object(b.b)("h4",{id:"updating-screen1"},"Updating Screen1"),Object(b.b)("p",null,"Now we can initialize the hour and minute in Screen1View with the values from the model and initialize the buffers for the Text Areas:"),Object(b.b)(c.a,{mdxType:"CodeHeader"},"Screen1View.cpp"),Object(b.b)("pre",null,Object(b.b)("code",Object(l.a)({parentName:"pre"},{className:"language-cpp"}),'...\nvoid Screen1View::setupScreen()\n{\n    Screen1ViewBase::setupScreen();\n\n    hour = presenter->getHour();\n    minute = presenter->getMinute();\n\n    Unicode::snprintf(textAreaHourBuffer, TEXTAREAHOUR_SIZE, "%02d", hour);\n    Unicode::snprintf(textAreaMinuteBuffer, TEXTAREAMINUTE_SIZE, "%02d", minute);\n}\n...\n')),Object(b.b)("p",null,"For saving the hour and minute values, the virtual functions, that were created under interactions, for the two save buttons, is implemented in ",Object(b.b)("inlineCode",{parentName:"p"},"Screen1View.hpp")," and stores the values in the model (via the presenter):"),Object(b.b)(c.a,{mdxType:"CodeHeader"},"Screen1View.hpp"),Object(b.b)("pre",null,Object(b.b)("code",Object(l.a)({parentName:"pre"},{className:"language-cpp"}),"...\npublic:\n    virtual void buttonSaveHourClicked()\n    {\n        presenter->saveHour(hour);\n    }\n\n    virtual void buttonSaveMinuteClicked()\n    {\n        presenter->saveMinute(minute);\n    }\n...\n")),Object(b.b)("p",null,"Screen1 now gets the initial values for hour and minute from the model."),Object(b.b)("h4",{id:"updating-screen2"},"Updating Screen2"),Object(b.b)("p",null,"Screen2 also needs to synchronize its values with the model."),Object(b.b)("p",null,"Similar to Screen1, the initial value shown in the text clock must match the data from the Model."),Object(b.b)(c.a,{mdxType:"CodeHeader"},"Screen2View.cpp"),Object(b.b)("pre",null,Object(b.b)("code",Object(l.a)({parentName:"pre"},{className:"language-cpp"}),'...\nvoid Screen2View::setupScreen()\n{\n    Screen2ViewBase::setupScreen();\n\n    hour = presenter->getHour();\n    minute = presenter->getMinute();\n\n    Unicode::snprintf(textClockBuffer1, TEXTCLOCKBUFFER1_SIZE, "%02d", hour);\n    Unicode::snprintf(textClockBuffer2, TEXTCLOCKBUFFER2_SIZE, "%02d", minute);\n}\n...\n')),Object(b.b)("p",null,"This fetches the hour and minute from the Model. The updated values must be sent back to the Model when we leave the screen (to go to the configuration screen on ",Object(b.b)("inlineCode",{parentName:"p"},"Screen1"),"):"),Object(b.b)(c.a,{mdxType:"CodeHeader"},"Screen2View.cpp"),Object(b.b)("pre",null,Object(b.b)("code",Object(l.a)({parentName:"pre"},{className:"language-cpp"}),"...\nvoid Screen2View::tearDownScreen()\n{\n    presenter->saveHour(hour);\n    presenter->saveMinute(minute);\n\n    Screen2ViewBase::tearDownScreen();\n}\n...\n")),Object(b.b)("p",null,"This will send the updated values of hour and minute to the model just before going to the configuration screen."),Object(b.b)("p",null,"This concludes the small application and thereby tutorial 3."))}p.isMDXComponent=!0}}]);