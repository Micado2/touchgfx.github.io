<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-162710244-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>

<title data-react-helmet="true">Abstraction Layer Architecture | TouchGFX Documentation</title>

<meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"><meta data-react-helmet="true" property="og:title" content="TouchGFX Documentation"><meta data-react-helmet="true" name="twitter:card" content="summary"><meta data-react-helmet="true" name="description" content="import Figure from &#x27;@site/components/Figure&#x27;;"><meta data-react-helmet="true" property="og:description" content="import Figure from &#x27;@site/components/Figure&#x27;;"><meta data-react-helmet="true" property="og:url" content="https://support.touchgfx.com/docs/development/touchgfx-hal-development/touchgfx-architecture">

<link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png">


<link rel="stylesheet" href="/styles.cdb1878b.css">


<link rel="preload" href="/styles.fb438ccf.js" as="script">

<link rel="preload" href="/runtime~main.461b11dc.js" as="script">

<link rel="preload" href="/main.b799bff4.js" as="script">

<link rel="preload" href="/common.2399d9cc.js" as="script">

<link rel="preload" href="/2.7c0dfd88.js" as="script">

<link rel="preload" href="/3.68ee71aa.js" as="script">

<link rel="preload" href="/1be78505.7aa3ccb4.js" as="script">

<link rel="preload" href="/20ac7829.c5363d09.js" as="script">

<link rel="preload" href="/17896441.d556ceff.js" as="script">

<link rel="preload" href="/ebf98fec.ca47c201.js" as="script">

</head>
<body>

<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" target="_self" href="/docs/introduction/welcome"><img class="navbar__logo" src="/img/logo.png" alt="TouchGFX"></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" target="_blank" href="/api/">API</a><a class="navbar__item navbar__link" activeclassname="navbar__link--active" to="https://community.st.com/s/topic/0TO0X0000003iw6WAA/touchgfx" target="_blank" href="https://community.st.com/s/topic/0TO0X0000003iw6WAA/touchgfx">Community</a><a class="navbar__item navbar__link" activeclassname="navbar__link--active" to="https://touchgfx.com/" href="https://touchgfx.com/">TouchGFX.com</a><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" target="_self" href="/docs/introduction/welcome"><img class="navbar__logo" src="/img/logo.png" alt="TouchGFX"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" target="_blank" href="/api/">API</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="navbar__link--active" to="https://community.st.com/s/topic/0TO0X0000003iw6WAA/touchgfx" target="_blank" href="https://community.st.com/s/topic/0TO0X0000003iw6WAA/touchgfx">Community</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="navbar__link--active" to="https://touchgfx.com/" href="https://touchgfx.com/">TouchGFX.com</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="sidebarLogo_3ono"><img src="/img/logo.png" alt="TouchGFX"></div><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/introduction/welcome">Welcome</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/introduction/what-is-touchgfx">What is TouchGFX?</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/introduction/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/introduction/getting-started">Getting Started</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Basic Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/basic-concepts/embedded-graphics">Embedded Graphics</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/basic-concepts/color-formats">Color Formats</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/basic-concepts/framebuffer">Framebuffer</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/basic-concepts/graphics-engine">Graphics Engine</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/basic-concepts/rendering">Main Loop</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/basic-concepts/performance">Performance</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/basic-concepts/operating-system">Operating Systems</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Development</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/development/development-introduction">Introduction</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Hardware Selection</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/development/hardware-selection/hardware-selection-introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/hardware-selection/preliminary-considerations">Preliminary Considerations</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Hardware Components</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/development/hardware-selection/hardware-components/hardware-selection-mcu">MCU</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/hardware-selection/hardware-components/hardware-selection-display">Display</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/hardware-selection/hardware-components/hardware-selection-external-memories">External Memories</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Board Bring Up</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/development/board-bring-up/board-introduction">Introduction</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">How To</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/development/board-bring-up/how-to/01-create-project">1. Create Project</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/board-bring-up/how-to/02-cpu-running">2. CPU Running</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/board-bring-up/how-to/03-display-internal">3. Framebuffer in internal RAM</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/board-bring-up/how-to/04-enable-external-ram">4. External RAM</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/board-bring-up/how-to/05-display-external">5. Framebuffer in external RAM</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/board-bring-up/how-to/06-flash-external-addressable">6. External addressable flash</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/board-bring-up/how-to/07-flash-external-nonaddressable">7. External flash in block mode</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/board-bring-up/how-to/08-hardware-acceleration">8. Hardware acceleration</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/board-bring-up/how-to/09-touch-controller">9. Touch Controller</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/board-bring-up/how-to/10-physical-buttons">10. Physical Buttons</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/board-bring-up/how-to/11-flash-loader">11. Flash Loader</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">TouchGFX AL Development</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/development/touchgfx-hal-development/touchgfx-al-development-introduction">Introduction</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/docs/development/touchgfx-hal-development/touchgfx-architecture">Abstraction Layer Architecture</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/touchgfx-hal-development/touchgfx-generator">Generator User Guide</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Scenarios</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/development/touchgfx-hal-development/scenarios/scenarios-introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/touchgfx-hal-development/scenarios/scenarios-ltdc-parallel-rgb">LTDC/Parallel RGB</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/touchgfx-hal-development/scenarios/scenarios-fmc">FMC and SPI</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/touchgfx-hal-development/scenarios/scenarios-framebuffer-strategies">Framebuffer Strategies</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/board-bring-up/example-gpio">External events as triggers</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">UI Development</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-development-introduction">Introduction</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Software Architecture</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/software-architecture/model-view-presenter-design-pattern">Model-View-Presenter Design Pattern</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/software-architecture/screen-definition-and-mvp">The Screen Concept</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/software-architecture/code-structure">Code Structure</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Working with TouchGFX</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/working-with-touchgfx/using-ides-with-touchgfx">Using IDEs with TouchGFX</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/working-with-touchgfx/widgets-and-containers">Widgets and Containers</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/working-with-touchgfx/simulator">Simulator</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/working-with-touchgfx/compiling-and-flashing">Compiling &amp; Flashing</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/working-with-touchgfx/debugging">Debugging</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/working-with-touchgfx/examples">Examples</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Designer User Guide</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/designer-user-guide/startup-window">Startup Window</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/designer-user-guide/file-menu">File Menu</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/designer-user-guide/main-window">Main Window</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/designer-user-guide/canvas-view">Canvas View</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/designer-user-guide/images-view">Images View</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/designer-user-guide/texts-view">Texts View</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/designer-user-guide/config-view">Config View</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/designer-user-guide/interactions-view">Interactions</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">TouchGFX Engine Features</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/touchgfx-engine-features/custom-triggers-and-actions">Custom Triggers and Actions</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/touchgfx-engine-features/custom-containers">Custom Containers</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/touchgfx-engine-features/caching-bitmaps">Caching Bitmaps</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/touchgfx-engine-features/custom-widgets">Custom Widgets</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/touchgfx-engine-features/canvas-widgets">Canvas Widgets</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/touchgfx-engine-features/dynamic-bitmaps">Dynamic Bitmaps</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/touchgfx-engine-features/using-binary-fonts">Binary Fonts</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/touchgfx-engine-features/font-cache">Font Caching</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/touchgfx-engine-features/backend-communication">Backend Communication</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/touchgfx-engine-features/mixins">Mixins</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/touchgfx-engine-features/texts-and-fonts">Texts and Fonts</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/touchgfx-engine-features/languages-and-characters">Languages and Characters</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">UI Components</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Buttons</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/buttons/button">Button</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/buttons/button-with-label">ButtonWithLabel</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/buttons/button-with-icon">ButtonWithIcon</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/buttons/toggle-button">ToggleButton</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/buttons/radio-button">RadioButton</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/buttons/repeat-button">RepeatButton</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/buttons/flex-button">FlexButton</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Images</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/images/image">Image</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/images/scalable-image">ScalableImage</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/images/tiled-image">TiledImage</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/images/animated-image">AnimatedImage</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/images/texture-mapper">TextureMapper</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Containers</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/containers/container">Container</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/containers/scrollable-container">ScrollableContainer</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/containers/swipe-container">SwipeContainer</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/containers/list-layout">ListLayout</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/containers/modal-window">ModalWindow</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/containers/scroll-list">ScrollList</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/containers/scroll-wheel">ScrollWheel</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ProgressIndicators</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/progress-indicators/box-progress">BoxProgress</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/progress-indicators/image-progress">ImageProgress</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/progress-indicators/text-progress">TextProgress</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/progress-indicators/line-progress">LineProgress</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/progress-indicators/circle-progress">CircleProgress</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Shapes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/shapes/box">Box</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/shapes/box-with-border">BoxWithBorder</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/shapes/line">Line</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/shapes/circle">Circle</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/shapes/shape">Shape</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Miscellaneous</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/miscellaneous/slider">Slider</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/miscellaneous/text-area">TextArea</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/miscellaneous/analog-clock">AnalogClock</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/miscellaneous/digital-clock">DigitalClock</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/ui-components/general-ui-component-performance">General UI Component Performance</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Scenarios</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/scenarios/achieving-better-performance-with-cacheable-container">Achieving Better Performance with CacheableContainer</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/scenarios/loading-images-at-runtime">Loading Images at Runtime</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/scenarios/lowering-memory-usage-with-partial-framebuffer">Lowering Memory Usage with Partial Framebuffer</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/scenarios/using-the-l8-image-format-to-reduce-memory-consumption">Using the L8 Image Format to Reduce Memory Consumption</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/scenarios/creating-dynamic-l8-images">Creating Dynamic L8 Images</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/development/ui-development/scenarios/using-non-memory-mapped-flash">Using Non-Memory Mapped Flash for storing images</a></li></ul></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Miscellaneous</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/miscellaneous/updating-to-a-new-touchgfx-version">Updating to a new TouchGFX Version</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/miscellaneous/getting-help">Getting Help</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/miscellaneous/known-issues">Known Issues</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/miscellaneous/changelog">Changelog</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/miscellaneous/3rd-party-components-in-touchgfx">3rd Party Components in TouchGFX</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tutorials</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/tutorials/tutorial-01">Tutorial 1: Trying Out the Examples</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/tutorials/tutorial-02">Tutorial 2: Creating Your Own Application</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/tutorials/tutorial-03">Tutorial 3: Applications with Multiple Screens</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/tutorials/tutorial-04">Tutorial 4: Creating a Scroll Wheel with Custom Behavior</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/tutorials/tutorial-05">Tutorial 5: Creating Custom Triggers and Actions</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="padding-vert--lg"><div class="container"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Abstraction Layer Architecture</h1></header><div class="markdown"><p>As described in the previous section, the TouchGFX AL has a particular set of responsibilities.
Responsibilities are either implemented in the hardware part of the AL (HAL) or the part of the AL that syncronizes with TouchGFX Engine, typically through an RTOS (OSAL). The following table summarizes these responsibilities which were outlined in the previous section:</p><table><thead><tr><th>Responsibility</th><th>Operating system or Hardware</th></tr></thead><tbody><tr><td><a href="#synchronize-touchgfx-engine-main-loop-with-display-transfer">Synchronize TouchGFX Engine main loop with display transfer</a></td><td>Operating system and hardware</td></tr><tr><td><a href="#report-touch-and-physical-button-events">Report touch and physical button events</a></td><td>Hardware</td></tr><tr><td><a href="#synchronize-framebuffer-access">Synchronize framebuffer access</a></td><td>Operating system</td></tr><tr><td><a href="#report-the-next-available-framebuffer-area">Report the next available framebuffer area</a></td><td>Hardware</td></tr><tr><td><a href="#perform-render-operations">Perform render operations</a></td><td>Hardware</td></tr><tr><td><a href="#handle-framebuffer-transfer-to-display">Handle framebuffer transfer to display </a></td><td>Hardware</td></tr></tbody></table><p>Each of the following subsections highlight what should be done to fulfill the above responsibilities. For custom hardware platforms the TouchGFX Generator, inside STM32CubeMX, can generate most of the AL and accompanying TouchGFX project. The remaining parts, that the AL developer must implement manually, are pointed out through code comments and notifications through the TouchGFX Generator. <a href="/docs/development/touchgfx-hal-development/touchgfx-generator">Read more</a> about the TouchGFX Generator in the next section.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="abstraction-layer-classes"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#abstraction-layer-classes" title="Direct link to heading">#</a>Abstraction Layer Classes</h3><p>The HAL is accessed by the TouchGFX Engine through concrete sub-classes of <code>HAL</code>. These sub-classes are generated by the TouchGFX Generator.  The generator, which is <em>the</em> primary tool for creation of the Abstraction Layer, can generate both the part of the HAL that reflects configurations from CubeMX, as well as the OSAL for CMSIS V1 and V2. Please read the section on <a href="/docs/development/touchgfx-hal-development/touchgfx-generator"> TouchGFX Generator</a> for further details. Generally, the architecture of the HAL is in the following figure.</p><div class="figure noshadow"><a href="/img/development/touchgfx-hal-development/code-architecture.png" target="_blank"><img width="200" src="/img/development/touchgfx-hal-development/code-architecture.png"></a><p>Hierarchy of generated code</p></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="synchronize-touchgfx-engine-main-loop-with-display-transfer"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#synchronize-touchgfx-engine-main-loop-with-display-transfer" title="Direct link to heading">#</a>Synchronize TouchGFX Engine main loop with display transfer</h2><p>The main idea behind this step is to block the TouchGFX Engine main loop when rendering is done, ensuring that no further frames are produced. Once the display is ready the OSAL signals the blocked Engine main loop to continue producing frames.</p><p>In order to fulfil this responsibility the typical way of a TouchGFX AL is to utilize the engine hook <em>Rendering done</em> and the interrupt <em>Display Ready</em>, as outlined in the previous section. The OSAL defines a function <code>OSWrappers::signalVSync</code> in which developers can signal the semaphore that the engine waits upon when it calls <code>OSWrappers::signalVSync</code> </p><div class="highlight highlight-tip"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></div>Tip</h5></div><div class="highlight-content">The TouchGFX Generator can create a complete OSAL for CMSIS V1 and V2.</div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="rendering-done"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#rendering-done" title="Direct link to heading">#</a>Rendering Done</h3><p>The <em>Rendering done</em> hook, <code>OSWrappers::waitForVSync</code>, is called by the TouchGFX Engine after rendering is complete.</p><p>When implementing this AL method, the AL must block the graphics engine until it is time to render the next frame. The standard method to implement this block is to peform a blocking read from a message queue. The HAL developer is free to use any method to implement the block if this is not feasible.</p><div class="highlight highlight-tip"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></div>Tip</h5></div><div class="highlight-content">The TouchGFX Generator can also generate an empty OSAL that uses spinlocks to wait, rather than RTOS primitives if such software is not available.</div></div><p>When <code>OSWrappers::signalVSync</code> is signaled (or the semaphore/queue used in <code>OSWrappers::waitForVSync</code> is signaled) TouchGFX will start rendering the next application frame. The following code based on CMSIS V1 causes the TouchGFX engine to block until an element is added to the queue by another part of the system, typically an interrupt syncronized with the display.</p><div class="code-header"><div><h5>RTOS_OSWrappers.cpp</h5></div></div><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-cpp codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">static</span><span class="token plain"> osMessageQId vsync_queue </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//Queue identifier is assigned elsewhere</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> OSWrappers</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">waitForVSync</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//Wait for next VSYNC to occur, by reading from the queue</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">osMessageGet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">vsync_queue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> osWaitForever</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></code></pre></div><p>If not using an RTOS, the TouchGFX Generator provides the following
implementation for <code>waitForVSync</code> using a volatile variable.</p><div class="code-header"><div><h5>NO_OS_OSWrappers.cpp</h5></div></div><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-cpp codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">static</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">volatile</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">uint8_t</span><span class="token plain"> vsync_sem </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> OSWrappers</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">waitForVSync</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">while</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain">vsync_sem</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Perform other work while waiting</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></code></pre></div><div class="highlight highlight-tip"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></div>Tip</h5></div><div class="highlight-content"><li><b><i>While</i></b> TouchGFX Engine is waiting to produce the next frame other tasks can do important work.</li></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="display-ready"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#display-ready" title="Direct link to heading">#</a>Display ready</h3><p>The <em>Display ready</em> signal to unblock the main loop should come from an interrupt from a display controller, from the display itself or even from a hardware timer. The source of the signal is dependant on the
type of display.</p><p>The <code>OSWrappers</code> class defines a function for this signal: <code>OSWrappers::signalVsync</code>. The implementation of the function must unblock the main loop by satisfying the wait condition used in <code>OSWrappers::waitForVSync</code>.</p><p>Continuing from the above CMSIS RTOS example, the following code puts a message into the message queue <code>vsync_queue</code> which unblocks the TouchGFX Engine.</p><div class="code-header"><div><h5>RTOS_OSWrappers.cpp</h5></div></div><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-cpp codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> OSWrappers</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">signalVSync</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">vsync_queue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">osMessagePut</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">vsync_queue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> dummy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></code></pre></div><p>This <code>OSWrappers::signalVSync</code> method must be called at hardware level from an interrupt for e.g. an LTDC controller, an external signal from the display, or a hardware timer.</p><p>If not using an RTOS use a variable and assign a non-zero value to break the while-loop.</p><div class="code-header"><div><h5>NO_OS_OSWrappers.cpp</h5></div></div><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-cpp codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> OSWrappers</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">signalVSync</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    vsync_sem </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></code></pre></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="report-touch-and-physical-button-events"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#report-touch-and-physical-button-events" title="Direct link to heading">#</a>Report touch and physical button events</h2><p>Before rendering a new frame, the TouchGFX Engine collects external input from the <code>TouchController</code> and <code>ButtonController</code> interfaces.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="touch-coordinates"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#touch-coordinates" title="Direct link to heading">#</a>Touch Coordinates</h3><p>Coordinates from the touch controller are translated into click-, drag- and gesture events by the engine and passed to the application. The following code is generated by the TouchGFX Generator:</p><div class="code-header"><div><h5>TouchGFXConfiguration.cpp</h5></div></div><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-cpp codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">static</span><span class="token plain"> STM32TouchController tc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">static</span><span class="token plain"> STM32L4DMA dma</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">static</span><span class="token plain"> LCD24bpp display</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">static</span><span class="token plain"> ApplicationFontProvider fontProvider</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">static</span><span class="token plain"> Texts texts</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">static</span><span class="token plain"> TouchGFXHAL </span><span class="token function" style="color:rgb(130, 170, 255)">hal</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">dma</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> display</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> tc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">390</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">390</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></code></pre></div><p>During the TouchGFX Engine render cycle, when collecting input, the engine calls the <code>sampleTouch()</code> function on the <em>tc</em> object:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-cpp codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">bool</span><span class="token plain"> STM32TouchController</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">sampleTouch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">int32_t</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">int32_t</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></code></pre></div><p>The implementation, provided by the AL developer, should assign the read touch coordinate values to x and y and return whether or not a touch was detected (true or false).</p><div class="highlight highlight-tip"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></div>Tip</h5></div><div class="highlight-content">The TouchGFX Generator will generate a class that defines the TouchController interface functions as empty. The HAL developer must fill in the implementation.</div></div><p>There are multiple ways of implementing this function:</p><ol><li><strong><em>Polling in sampleTouch()</em></strong>: Read touch status from the hardware touch controller (typically I2C) by sending a request and polling for the result. This impacts the overall render time of the application as the i2C round-trip is often up to 1ms during which the graphics enging is blocked.</li><li><strong><em>Interrupt based</em></strong>: Another possibility is to use interrupts. The I2C read command is started regularly by a timer or as a response to an external interrupt from the touch hardware. When the I2C data is available (another interrupt) the data is made available to the <code>STM32TouchController</code> through a message queue or global
variables. The code below from <code>STM32TouchController.cpp</code> (created by TouchGFX Generator) shows how <code>sampleTouch</code> could look for a system with an RTOS:</li></ol><div class="code-header"><div><h5>STM32TouchController.cpp</h5></div></div><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-cpp codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">bool</span><span class="token plain"> STM32TouchController</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">sampleTouch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">int32_t</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">int32_t</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">osMessageQueueGet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">mid_MsgQueue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">NULL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0U</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> osOK</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        x </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        y </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></code></pre></div><p>The location of this file will be outlined in the next chapter on TouchGFX Generator</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="other-external-events"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#other-external-events" title="Direct link to heading">#</a>Other External Events</h3><p>The Button Controller interface, <code>touchgfx::ButtonController</code>, can be used to map hardware signals (buttons or other) to events to the the application. The reaction to these events can be configured within TouchGFX Designer.</p><p>The use of this interface is similar to the Touch Controller above, except that it is not mandatory to have a ButtonController. To use it, create an instance of a class implementing the <code>ButtonController</code> interface, and pass a reference to the instance to the HAL:</p><div class="code-header"><div><h5>MyButtonController.cpp</h5></div></div><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-cpp codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">MyButtonController</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> touchgfx</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain">ButtonController</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">bool</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">sample</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">uint8_t</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain"> key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//Sample IO, set key, return true/false</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></code></pre></div><div class="code-header"><div><h5>TouchGFXConfiguration.cpp</h5></div></div><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-cpp codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">static</span><span class="token plain"> MyButtonController bc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">touchgfx_init</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  hal</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">initialize</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  hal</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">setButtonController</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">bc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></code></pre></div><p>The <em>sample</em> method in your ButtonController class is called before each frame. If you return true, the key value will be passed to the <em>handleKeyEvent</em> eventhandler of the current Screen.</p><div class="highlight highlight-further-reading"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div>Further reading</h5></div><div class="highlight-content">See the <a href="/docs/development/ui-development/designer-user-guide/interactions-view">Interactions</a> article for further information on how to use values sampled through the ButtonController as triggers for interactions in the designer.</div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="synchronize-framebuffer-access"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#synchronize-framebuffer-access" title="Direct link to heading">#</a>Synchronize framebuffer access</h2><p>Multiple actors may be interested in accessing the framebuffer memory.</p><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td>1</td><td>CPU</td><td>Reads and writes pixels during rendering</td></tr><tr><td>2</td><td>DMA2D<strong>*</strong></td><td>Reads and writes pixels during hardware assisted rendering</td></tr><tr><td>3</td><td>LTDC</td><td>Reads pixels during transfer to parallel RGB display</td></tr><tr><td>4</td><td>DMA</td><td>Read pixels during transfer to SPI display</td></tr></tbody></table><p>The TouchGFX Engine synchronizes framebuffer access through the <code>OSWrappers</code> interface and peripherals (e.g. DMA2D) that also wish to access the framebuffer must do the same. The normal design is to use a semaphore to guard the access to the framebuffer, but other synchronization mechanisms can be used.</p><p>The following table shows a list of functions in the <code>OSWrappers</code> class (OSWrappers.cpp) that can be generated by the TouchGFX Generator or manually by the user.</p><table><thead><tr><th>Method</th><th>Description</th></tr></thead><tbody><tr><td><code>takeFrameBufferSemaphore</code></td><td>Called by graphics engine to get exclusive access to the framebuffer. This will block the engine until the DMA2D is done (if running)</td></tr><tr><td><code>tryTakeFrameBufferSemaphore</code></td><td>Ensure that the lock is taken. This method does not block, but ensures that the next call to takeFrameBufferSemaphore will block its caller</td></tr><tr><td><code>giveFrameBufferSemaphore</code></td><td>Releases the framebuffer lock</td></tr><tr><td><code>giveFrameBufferSemaphoreFromISR</code></td><td>Releases the framebuffer lock from an interrupt context</td></tr></tbody></table><div class="highlight highlight-tip"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></div>Tip</h5></div><div class="highlight-content">The TouchGFX Generator can generate a ChromART driver that synchronizes using the OSWrappers interface as well as implementations for functions that perform this synchronization depending on choice of RTOS.</div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="report-the-next-available-framebuffer-area"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#report-the-next-available-framebuffer-area" title="Direct link to heading">#</a>Report the next available framebuffer area</h2><p>Regardless of rendering strategy TouchGFX Engine must know, in each tick, which memory area it should render pixels to. Using single- or double framebuffer strategies the TouchGFX Engine will write pixel data to a memory area according to the full width, height, and bit depth, of the framebuffer. The graphics engine takes care of swapping between the two buffers in a double buffer setup.</p><p>It is possible to limit the access to the framebuffer to part of the framebuffer. The method <code>HAL::getTFTCurrentLine()</code> can be reimplemented in your HAL subclass. Return the line number above which it is save for the graphics engine to draw.</p><p>Using a Partial Framebuffer strategy the developer defines one or more blocks of memory that TouchGFX Engine will use when rendering. Read more about that <a href="/docs/development/ui-development/scenarios/lowering-memory-usage-with-partial-framebuffer">here</a>.</p><div class="highlight highlight-tip"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></div>Tip</h5></div><div class="highlight-content">TouchGFX Generator can provide configurations for all supported framebuffer strategies.</div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="perform-render-operations"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#perform-render-operations" title="Direct link to heading">#</a>Perform Render Operations</h2><p>Rendering and displaying graphics are rarely the sole purposes of an application. Other tasks also need to use the cpu. One goal of TouchGFX is to draw the user interface using as few cpu cycles as possible. The HAL class abstracts the DMA2D found on many STM32
microcontrollers (or other hardware capabilities) and makes this available to the graphics engine.</p><p>When rendering assets such as bitmaps to the framebuffer, the TouchGFX Engine checks if the HAL has the capability to &#x27;blit&#x27; a portion of- or all of the bitmap into to the framebuffer. If so, the drawing operation is delegated to the HAL rather than being handled by the CPU.</p><p>The engine calls the method <code>HAL::getBlitCaps()</code> to get a description of the capabilities of the hardware. You HAL subclass can reimplement this to add the capabilities.</p><p>When the engine is drawing the user interface it will call operations
on the HAL class, e.g. <code>HAL::blitCopy</code>, that queue the operations for
the DMA. If the HAL does not report the required capability, the
graphics engine will use a software rendering fallback.</p><div class="highlight highlight-tip"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></div>Tip</h5></div><div class="highlight-content"> Many STM32 MCUs have a ChromART chip which can move data from e.g. external Flash memory into the framebuffer while alpha blending pixels.<p>For many MCUs, TouchGFX Generator can generate a ChromART driver which adds the capability of several &#x27;blit&#x27; operations using the ChromART chip.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="handle-framebuffer-transfer-to-display"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#handle-framebuffer-transfer-to-display" title="Direct link to heading">#</a>Handle framebuffer transfer to display</h2><p>In order to transfer the framebuffer to the display the hook &quot;Rendering of area complete&quot; is often utilized in a TouchGFX AL.
The engine signals the AL once rendering of a part of the framebuffer has been completed. The AL can choose how to transfer this part of the framebuffer to the display.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="rendering-of-area-complete"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#rendering-of-area-complete" title="Direct link to heading">#</a>Rendering of area complete</h3><p>In code this hook is the virtual function <code>HAL::flushFrameBuffer(Rect&amp; rect)</code>.</p><p>On STM32 microcontrollers with LTDC controllers we don&#x27;t need to do
anything to transmit the framebuffer after every rendering. This
happens continuously with a given frequency after the LTDC has been
initialized and therefore we can leave the implementation of this method empty.</p><p>For other display types like SPI or 8080 you need to transfer the
framebuffer manually.</p><p>The implementation of this function allows developers to initiate a manual transfer of that area of the framebuffer to a display with GRAM:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-cpp codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> TouchGFXHAL</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">flushFrameBuffer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> touchgfx</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token plain">Rect</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain"> r</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    HAL</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">flushFrameBuffer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">rect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//call superclass</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//start transfer if not running already!</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token function" style="color:rgb(130, 170, 255)">IsTransmittingData</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">uint8_t</span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> pixels </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Calculate pixel address</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">SendFrameBufferRect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">uint8_t</span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">pixels</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> r</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> r</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> r</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">width</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> r</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">height</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">else</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Queue rect for later or wait here</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></code></pre></div><div class="highlight highlight-further-reading"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div>Further reading</h5></div><div class="highlight-content">Read through the scenarios for concrete examples of how to support various display interfaces.</div></div></div></article><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/development/touchgfx-hal-development/touchgfx-al-development-introduction"><h5 class="pagination-nav__link--sublabel">Previous</h5><h4 class="pagination-nav__link--label"> Introduction</h4></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/development/touchgfx-hal-development/touchgfx-generator"><h5 class="pagination-nav__link--sublabel">Next</h5><h4 class="pagination-nav__link--label">Generator User Guide </h4></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#abstraction-layer-classes" class="contents__link">Abstraction Layer Classes</a></li><li><a href="#synchronize-touchgfx-engine-main-loop-with-display-transfer" class="contents__link">Synchronize TouchGFX Engine main loop with display transfer</a><ul><li><a href="#rendering-done" class="contents__link">Rendering Done</a></li><li><a href="#display-ready" class="contents__link">Display ready</a></li></ul></li><li><a href="#report-touch-and-physical-button-events" class="contents__link">Report touch and physical button events</a><ul><li><a href="#touch-coordinates" class="contents__link">Touch Coordinates</a></li><li><a href="#other-external-events" class="contents__link">Other External Events</a></li></ul></li><li><a href="#synchronize-framebuffer-access" class="contents__link">Synchronize framebuffer access</a></li><li><a href="#report-the-next-available-framebuffer-area" class="contents__link">Report the next available framebuffer area</a></li><li><a href="#perform-render-operations" class="contents__link">Perform Render Operations</a></li><li><a href="#handle-framebuffer-transfer-to-display" class="contents__link">Handle framebuffer transfer to display</a><ul><li><a href="#rendering-of-area-complete" class="contents__link">Rendering of area complete</a></li></ul></li></ul></div></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="text--center"><div>All rights reserved  2020 STMicroelectronics | <a href="https://www.st.com/content/st_com/en/common/terms-of-use.html">Terms of use</a> | <a href="https://www.st.com/content/ccc/resource/legal/legal_agreement/sales_agreement/49/05/8c/68/a0/35/4a/6e/ST%20Terms%20and%20Conditions%20of%20Sales.pdf/files/ST%20Terms%20and%20Conditions%20of%20Sales.pdf/_jcr_content/translations/en.ST%20Terms%20and%20Conditions%20of%20Sales.pdf">Sales Terms & Conditions</a> | <a href="https://www.st.com/content/st_com/en/common/privacy-policy.html">Privacy Policy</a> | <a href="https://www.st.com/content/st_com/en/common/cookies-policy.html">Manage cookies</a> | <a href="https://app-de.onetrust.com/app/#/webform/2b87200d-4023-4588-9df7-ab0cdea1a67e">Exercise your rights</a></div></div></div></footer>
</div>

<script src="/styles.fb438ccf.js"></script>

<script src="/runtime~main.461b11dc.js"></script>

<script src="/main.b799bff4.js"></script>

<script src="/common.2399d9cc.js"></script>

<script src="/2.7c0dfd88.js"></script>

<script src="/3.68ee71aa.js"></script>

<script src="/1be78505.7aa3ccb4.js"></script>

<script src="/20ac7829.c5363d09.js"></script>

<script src="/17896441.d556ceff.js"></script>

<script src="/ebf98fec.ca47c201.js"></script>


</body>
</html>