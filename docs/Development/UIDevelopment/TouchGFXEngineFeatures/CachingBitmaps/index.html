<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus">


<title data-react-helmet="true">Caching Bitmaps | TouchGFX Documentation</title>

<meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"><meta data-react-helmet="true" property="og:title" content="TouchGFX Documentation"><meta data-react-helmet="true" name="twitter:card" content="summary"><meta data-react-helmet="true" name="description" content="import Figure from &#x27;@site/components/Figure&#x27;;"><meta data-react-helmet="true" property="og:description" content="import Figure from &#x27;@site/components/Figure&#x27;;"><meta data-react-helmet="true" property="og:url" content="https://touchgfx.github.io/docs/Development/UIDevelopment/TouchGFXEngineFeatures/CachingBitmaps">

<link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png">


<link rel="stylesheet" href="/styles.cdb1878b.css">


<link rel="preload" href="/styles.8e46bf91.js" as="script">

<link rel="preload" href="/runtime~main.8fd45071.js" as="script">

<link rel="preload" href="/main.1801c4b7.js" as="script">

<link rel="preload" href="/common.fce9659d.js" as="script">

<link rel="preload" href="/2.3b43b795.js" as="script">

<link rel="preload" href="/3.b0ded709.js" as="script">

<link rel="preload" href="/1be78505.4b59c28b.js" as="script">

<link rel="preload" href="/20ac7829.338acc89.js" as="script">

<link rel="preload" href="/17896441.2aeaded5.js" as="script">

<link rel="preload" href="/aa64f3e9.3c02e882.js" as="script">

</head>
<body>

<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" target="_self" href="/docs/Introduction/Welcome"><img class="navbar__logo" src="/img/logo.png" alt="My Site Logo"></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/Introduction/Welcome">Docs</a><a class="navbar__item navbar__link" target="_blank" href="/api/">API</a><a class="navbar__item navbar__link" activeclassname="navbar__link--active" to="https://community.st.com/s/topic/0TO0X0000003iw6WAA/touchgfx" target="_blank" href="https://community.st.com/s/topic/0TO0X0000003iw6WAA/touchgfx">Community</a><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" target="_self" href="/docs/Introduction/Welcome"><img class="navbar__logo" src="/img/logo.png" alt="My Site Logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/Introduction/Welcome">Docs</a></li><li class="menu__list-item"><a class="menu__link" target="_blank" href="/api/">API</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="navbar__link--active" to="https://community.st.com/s/topic/0TO0X0000003iw6WAA/touchgfx" target="_blank" href="https://community.st.com/s/topic/0TO0X0000003iw6WAA/touchgfx">Community</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="sidebarLogo_3ono"><img src="/img/logo.png" alt="My Site Logo"></div><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/Introduction/Welcome">Welcome</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Introduction/WhatIsTouchGFX">What is TouchGFX?</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Introduction/Installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Introduction/GettingStarted">Getting Started</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Basic Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/BasicConcepts/EmbeddedGraphics">Embedded Graphics</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/BasicConcepts/Framebuffer">Framebuffer</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/BasicConcepts/GraphicsEngine">Graphics Engine</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/BasicConcepts/Rendering">Main Loop</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/BasicConcepts/Performance">Performance</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Development</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/Development/DevelopmentIntroduction">Introduction</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Hardware Selection</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/Development/HardwareSelection/HardwareSelectionIntroduction">Introduction</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Hardware Components</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/Development/HardwareSelection/HardwareComponents/HardwareSelectionMCU">MCU</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/HardwareSelection/HardwareComponents/HardwareSelectionDisplay">Display</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/HardwareSelection/HardwareComponents/HardwareSelectionExternalFlash">External Flash</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/HardwareSelection/HardwareComponents/HardwareSelectionExternalRAM">External RAM</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/HardwareSelection/HardwareComponents/HardwareSelectionBus">Bus</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/HardwareSelection/FindingTheRightHardware">Finding the Right Hardware</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/HardwareSelection/HardwareSelectionScenarios">Scenarios</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Board Bring Up</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/Development/BoardBringUp/BoardIntroduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/BoardBringUp/BoardDisplay">Display</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/BoardBringUp/BoardExGPIO">External events as triggers</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">TouchGFX HAL Development</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/Development/TouchGFXHALDevelopment/TouchGFXHALDevelopmentIntroduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/TouchGFXHALDevelopment/TouchGFXHALDevelopmentArchitecture">Abstraction Layer Architecture</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/TouchGFXHALDevelopment/TouchGFXHALDevelopmentGenerator">Generator User Guide</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Scenarios</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/Development/TouchGFXHALDevelopment/scenarios/TouchGFXHALDevelopmentScenariosIntro">Introduction</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/TouchGFXHALDevelopment/TouchGFXHALDevelopmentScenarios">LTDC/Parallel RGB</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/TouchGFXHALDevelopment/scenarios/TouchGFXHALDevelopmentScenariosFMC">FMC / Intel 8080</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/TouchGFXHALDevelopment/scenarios/TouchGFXHALDevelopmentScenariosDSI">LTDC+DSI</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/TouchGFXHALDevelopment/scenarios/TouchGFXHALDevelopmentScenariosSPI">SPI</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/BoardBringUp/BoardExGPIO">External events as triggers</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">UI Development</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIDevelopmentIntroduction">Introduction</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Software Architecture</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/software-architecture/model-view-presenter-design-pattern">Model-View-Presenter Design Pattern</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/software-architecture/screen-definition-and-mvp">The Screen Concept</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/software-architecture/code-structure">Code Structure</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Working with TouchGFX</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/WorkingWithTouchGFX/using-ides-with-touchgfx">Using IDEs with TouchGFX</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/WorkingWithTouchGFX/widgets-and-containers">Widgets and Containers</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/WorkingWithTouchGFX/simulator">Simulator</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/WorkingWithTouchGFX/compiling-and-flashing">Compiling &amp; Flashing</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/WorkingWithTouchGFX/Debugging">Debugging</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Designer User Guide</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/DesignerUserGuide/StartupWindow">Startup Window</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/DesignerUserGuide/FileMenu">File Menu</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/DesignerUserGuide/MainWindow">Main Window</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/DesignerUserGuide/CanvasView">Canvas View</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/DesignerUserGuide/ImagesView">Images View</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/DesignerUserGuide/TextsView">Texts View</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/DesignerUserGuide/ConfigView">Config View</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/DesignerUserGuide/Interactions">Interactions</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">TouchGFX Engine Features</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/TouchGFXEngineFeatures/CustomTriggersAndActions">Custom Triggers and Actions</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/TouchGFXEngineFeatures/custom-containers">Custom Containers</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/TouchGFXEngineFeatures/CanvasWidgets">Canvas Widgets</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/docs/Development/UIDevelopment/TouchGFXEngineFeatures/CachingBitmaps">Caching Bitmaps</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/TouchGFXEngineFeatures/CustomWidgets">Custom Widgets</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/TouchGFXEngineFeatures/CanvasWidgets">Canvas Widgets</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/TouchGFXEngineFeatures/DynamicBitmaps">Dynamic Bitmaps</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/TouchGFXEngineFeatures/using-binary-fonts">Binary Fonts</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/TouchGFXEngineFeatures/FontCache">Font Caching</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/TouchGFXEngineFeatures/backend-communication">Backend Communication</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/TouchGFXEngineFeatures/mixins">Mixins</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/TouchGFXEngineFeatures/TextsAndFonts">Texts and Fonts</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/TouchGFXEngineFeatures/LanguagesAndCharacters">Languages and Characters</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">UI Components</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Buttons</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/Buttons/Button">Button</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/Buttons/ButtonWithLabel">ButtonWithLabel</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/Buttons/ButtonWithIcon">ButtonWithIcon</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/Buttons/ToggleButton">ToggleButton</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/Buttons/RadioButton">RadioButton</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/Buttons/RepeatButton">RepeatButton</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/Buttons/FlexButton">FlexButton</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Images</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/Images/Image">Image</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/Images/ScalableImage">ScalableImage</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/Images/TiledImage">TiledImage</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/Images/AnimatedImage">AnimatedImage</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/Images/TextureMapper">TextureMapper</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Containers</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/Containers/Container">Container</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/Containers/ScrollableContainer">ScrollableContainer</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/Containers/SwipeContainer">SwipeContainer</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/Containers/ListLayout">ListLayout</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/Containers/ModalWindow">ModalWindow</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/Containers/ScrollList">ScrollList</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/Containers/ScrollWheel">ScrollWheel</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ProgressIndicators</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/ProgressIndicators/BoxProgress">BoxProgress</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/ProgressIndicators/ImageProgress">ImageProgress</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/ProgressIndicators/TextProgress">TextProgress</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/ProgressIndicators/LineProgress">LineProgress</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/ProgressIndicators/CircleProgress">CircleProgress</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Shapes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/Shapes/Box">Box</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/Shapes/BoxWithBorder">BoxWithBorder</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/Shapes/Line">Line</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/Shapes/Circle">Circle</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/Shapes/Shape">Shape</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Miscellaneous</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/Miscellaneous/Slider">Slider</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/Miscellaneous/TextArea">TextArea</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/Miscellaneous/AnalogClock">AnalogClock</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/Miscellaneous/DigitalClock">DigitalClock</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/UIComponents/GeneralUIComponentPerformance">General UI Component Performance</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Scenarios</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/Scenarios/AchievingBetterPerformanceWithCacheableContainer">Achieving Better Performance with CacheableContainer</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/Scenarios/LoadingImagesAtRuntime">Loading Images at Runtime</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/Scenarios/LoweringMemoryUsageWithPartialFrameBuffer">Lowering Memory Usage with Partial Framebuffer</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/Scenarios/UsingTheL8ImageFormatToReduceMemoryConsumption">Using the L8 Image Format to Reduce Memory Consumption</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/Scenarios/CreatingDynamicL8Images">Creating Dynamic L8 Images</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Development/UIDevelopment/Scenarios/UsingNonMemoryMappedFlash">Using Non-Memory Mapped Flash for storing images</a></li></ul></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Miscellaneous</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/miscellaneous/updating-to-a-new-touchgfx-version">Updating to a new TouchGFX Version</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/miscellaneous/known-issues">Known Issues</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/miscellaneous/changelog">Changelog</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/miscellaneous/3rd-party-components-in-touchgfx">3rd Party Components in TouchGFX</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/miscellaneous/supported-stm32-evaluation-kits">Supported STM32 Evaluation Kits</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tutorials</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/Tutorials/tutorial-01">Tutorial 1: Trying Out the Examples</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Tutorials/tutorial-02">Tutorial 2: Creating Your Own Application</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Tutorials/tutorial-03">Tutorial 3: Applications with Multiple Screens</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Tutorials/tutorial-04">Tutorial 4: Creating a Scroll Wheel with Custom Behavior</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Tutorials/tutorial-05">Tutorial 5: Creating Custom Triggers and Actions</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="padding-vert--lg"><div class="container"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Caching Bitmaps</h1></header><div class="markdown"><p>In this section we will discuss the bitmap cache in TouchGFX. The
bitmap cache is a dedicated RAM buffer where bitmaps can be stored (or
cached) by the application.
If a bitmap is cached, TouchGFX will automatically use the RAM cache
as pixel source when drawing the bitmap.</p><p>Bitmap caching can be benificial in many cases. Reading data from RAM
is often faster than reading from flash (especially when using the
Texturemapper because it uses non-linear memory access), so caching to
RAM can increase the performance of your UI. Be aware that caching
from internal flash to external RAM can reduce performance.
Caching to RAM also allows you to use the flash for other purposes
like log files while showing your UI, because bitmaps will be read
from RAM (in some cases writing to a flash requires it to be
non-memory mapped).  It can also be useful when you need to modify the
pixels of bitmap and therefore need the bitmap to be in modifiable
memory.</p><p>For performance reasons, TouchGFX requires all graphics data stored in
external flash to be directly accessible (through a pointer), without
going through a driver layer. This means that TouchGFX cannot render
directly from a non-memory mapped flash (like an SD-card).
To overcome this limitation the bitmap cache provides a mechanism for
caching some or all of the bitmap data in RAM during power-up.<br>
Bitmap caching is therefore useful when you need to store your bitmaps
on slow external storage like an USB-disk or SD-card.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="setup-the-bitmap-cache"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#setup-the-bitmap-cache" title="Direct link to heading">#</a>Setup the Bitmap Cache</h2><p>In order to use the bitmap caching feature, you need to first provide
a bitmap cache configuration to TouchGFX, and secondly (in some cases)
to provide a hardware specific implementation of the <code>BlockCopy</code> function for
reading data from your external storage.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="bitmap-cache-configuration"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#bitmap-cache-configuration" title="Direct link to heading">#</a>Bitmap Cache Configuration</h3><p>The bitmap cache configuration consists of a pointer to a buffer and
the size of the buffer. These two values must be provided to TouchGFX
in the call to touchgfx_generic_init or
Bitmap::registerBitmapDatabase. This call is normally found in the
BoardConfiguration.cpp file:</p><div class="code-header"><div><h5>BoardConfiguration.cpp (extract)</h5></div></div><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-cpp codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Place cache start address in SDRAM at address 0xC0008000;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">uint16_t</span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> cacheStartAddr </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">uint16_t</span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token number" style="color:rgb(247, 140, 108)">0xC0008000</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">uint32_t</span><span class="token plain"> cacheSize </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0x300000</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//3 MB, as example</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">HAL</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain"> hal </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> touchgfx_generic_init</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">STM32F4HAL</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">dma</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> display</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> tc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> DISPLAY_WIDTH</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> DISPLAY_HEIGHT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> cacheStartAddr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> cacheSize</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></code></pre></div><p>In the above example a 3 MB buffer in external memory is passed to
TouchGFX as bitmap cache. The address is selected by the application
programmer. In the next example we just declare an array and just pass
the address and size of the array. The specific location of the array
will depend on your linker script. This method is most often used when
creating a (small) bitmap cache in internal RAM:</p><div class="code-header"><div><h5>BoardConfiguration.cpp (extract)</h5></div></div><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-cpp codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Define an array for the bitmap cache</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">uint16_t</span><span class="token plain"> cache</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">128</span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token number" style="color:rgb(247, 140, 108)">1024</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//128 KB cache</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">HAL</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain"> hal </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> touchgfx_generic_init</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">STM32F4HAL</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">dma</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> display</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> tc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> DISPLAY_WIDTH</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> DISPLAY_HEIGHT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">cache</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">sizeof</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">cache</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></code></pre></div><div class="highlight highlight-tip"><div class="highlight-heading"><h5><div class="highlight-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></div>Tip</h5></div><div class="highlight-content">If you are using CubeMX, you should enable and configure the bitmap cache in the file TouchGFXConfiguration.cpp.</div></div><p>If you need to cache all your bitmaps, of course the size of the cache
must be large enough to contain all your bitmap data.<br>
Note: There is a small amount of memory used for bookkeeping (8 bytes
x number of bitmaps in the application), so you must allocate slightly
more memory than actually needed for the raw pixel data. This amount
depends on the number of bitmaps in your application, but a few
kilobytes of additional memory is usually enough.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="blockcopy-copies-data-from-flash-to-the-cache"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#blockcopy-copies-data-from-flash-to-the-cache" title="Direct link to heading">#</a>BlockCopy copies data from flash to the cache</h3><p>When you cache a bitmap, TouchGFX copies the pixels from the original
location to the bitmap cache using the <code>BlockCopy</code> function in the
HAL class.</p><p>If your bitmaps are stored in normal addressable flash (like internal
flash or a memory mapped external flash like a QSPI-flash), you do not
need to do anything. The built-in implementation works fine.</p><p>On the other hand, if your bitmaps are stored in flash that is not
addressable, e.g. a filesystem or non-memory mapped flash, then the
standard copy method is not sufficient and you need to provide an
updated version that is able to read from your specific flash storage.</p><p>Read more about this topic <a href="/docs/Development/UIDevelopment/Scenarios/UsingNonMemoryMappedFlash">Using Non-Memory Mapped flash for storing images</a>
section.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="cache-operations"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#cache-operations" title="Direct link to heading">#</a>Cache Operations</h2><p>The bitmap caching operations are all placed in the <code>Bitmap</code> class:</p><table><thead><tr><th><strong><code>Bitmap</code> caching method</strong></th><th><strong>Description</strong></th></tr></thead><tbody><tr><td><code>bool Bitmap::cache(BitmapId id)</code></td><td>This method caches a bitmap. The bitmap is only cached if enough unused memory is available in the cache. Returns true if the bitmap was cached. Caching an already cached bitmap does not do any work.</td></tr><tr><td><code>bool Bitmap::cacheReplaceBitmap(BitmapId out, BitmapId in)</code></td><td>This method replaces a bitmap (out) in the cache with another bitmap (in). The method will only succeed if the bitmap to be replaced is already cached and if the bitmaps have the same size (in bytes).</td></tr><tr><td><code>bool Bitmap::cacheRemoveBitmap(BitmapId id)</code></td><td>This method removes a bitmap from the cache. The memory used by the bitmap can be used for caching of another bitmap afterwards.</td></tr><tr><td><code>void Bitmap::clearCache()</code></td><td>This method removes all the cached bitmaps from the cache.</td></tr><tr><td><code>void Bitmap::cacheAll()</code></td><td>This method caches all bitmaps. It can not be used if the amount of RAM allocated for the cache (or available) is less than the total size of the bitmaps.</td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="cache-strategies"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#cache-strategies" title="Direct link to heading">#</a>Cache Strategies</h2><p>When the amount of RAM that you can allocate for your bitmap cache is
less than the total size of the bitmaps you can not cache all the
bitmaps during startup.<br>
You can e.g. select to cache only the bitmaps needed for the first
screen. When you change between your screens you can remove some or
all of the cached bitmaps and cache the bitmaps needed for the next
screen. This is examplified in the next section.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="cache-bitmap-on-a-screen-basis"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#cache-bitmap-on-a-screen-basis" title="Direct link to heading">#</a>Cache Bitmap on a Screen basis</h3><p>Your application user interface is composed of a set of Views. The
Views probably all use some bitmaps.  A simple strategy for caching is
to cache all the bitmaps used by a View in the <code>View::setupScreen</code> method and clear the cache in the</p><code>View::tearDownScreen</code> method:<div class="mdxCodeBlock_iHAB"><pre class="prism-code language-cpp codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> Screen1View</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">setupScreen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//ensure background is cached</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Bitmap</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">cache</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">BITMAP_SCREEN2_ID</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//cache some icons</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Bitmap</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">cache</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">BITMAP_ICON10_ID</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Bitmap</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">cache</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">BITMAP_ICON11_ID</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Bitmap</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">cache</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">BITMAP_ICON12_ID</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> Screen1View</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">tearDownScreen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//Remove all bitmaps from the cache</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Bitmap</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">clearCache</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></code></pre></div><p>The memory requirement for the cache is the size of the bitmaps used
by the screen with the biggest use of bitmaps.<br>
The drawback of this method is that if two <code>Views</code> both use a
bitmap, the bitmap will be erased from the cache on exit from the
first <code>View</code> and cached again on entry to the second <code>View</code>.</p><p>The Bitmap::cacheRemoveBitmap can be used to selective uncache bitmaps
and thus reduce this overhead. The drawback of the cacheRemoveBitmap
is that the cache memory will be fragmented.</p><p>Another general drawback of caching is that when you change your UI
(e.g. adding a button) you may need to update the caching code to
include the new bitmap.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="replace-the-background-bitmaps-in-the-cache"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#replace-the-background-bitmaps-in-the-cache" title="Direct link to heading">#</a>Replace the background Bitmaps in the cache</h3><p>If your application have a set of minor bitmaps (e.g. icons) and some
large full screen &quot;background&quot; bitmaps another strategy can be
advised:</p><p>Cache all the small bitmaps prior to entering the first screen. A good
place to do this is in the FrontendApplication constructor. Also cache
the background bitmap for the first screen:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-cpp codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">FrontendApplication</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">FrontendApplication</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Model</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain"> m</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> FrontendHeap</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain"> heap</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> touchgfx</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">MVPApplication</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token function" style="color:rgb(130, 170, 255)">transitionCallback</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token function" style="color:rgb(130, 170, 255)">frontendHeap</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">heap</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token function" style="color:rgb(130, 170, 255)">model</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">m</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//cache some icons</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Bitmap</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">cache</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">BITMAP_ICON10_ID</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Bitmap</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">cache</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">BITMAP_ICON11_ID</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Bitmap</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">cache</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">BITMAP_ICON12_ID</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//cache first background</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Bitmap</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">cache</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">BITMAP_SCREEN1_ID</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    backgroundBitmapCached </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> BITMAP_SCREEN1_ID</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//remember ID in a variable</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></code></pre></div><p>In the <code>View::setupScreen</code> method replace the
cached background bitmap with the required bitmap:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-cpp codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Screen1View</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">setupScreen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//ensure background is cached</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Bitmap</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">cacheReplaceBitmap</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">backgroundBitmapCached</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> BITMAP_SCREEN1_ID</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    backgroundBitmapCached </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> BITMAP_SCREEN1_ID</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//remember new ID of cached bitmap</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></code></pre></div><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-cpp codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> Screen1View</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">tearDownScreen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//nothing cache related</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></code></pre></div><p>The memory requirement for the cache using this strategy is the size
of the cached bitmaps and one background bitmap. Compared to the
previous method the code is simpler to maintain as the views have less
code. The performance is better as we move less bitmaps in and out of
the cache.</p><p>The cacheReplaceBitmap operation is preferable to the
cacheRemoveBitmap method as it does not fragment the memory.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="cache-memory-management"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#cache-memory-management" title="Direct link to heading">#</a>Cache Memory Management</h2><p>In order to get the full effect of the bitmap caching it is necessary to understand the internal operations of the cache.</p><p>The cache is implemented as a stack. New bitmaps are cached after of
the previously cached bitmaps. Memory used by a bitmap is marked as
&quot;free&quot; when the bitmap is removed from the cache, but the memory is not
immediately useable unless the removed bitmap was on top of the stack.<br>
If the bitmap was in &quot;the middle&quot; of the cache a compacting operation
is performed the next time Bitmap::cache is called to reclaim the
memory. This &quot;costly&quot; method can be avoided if you do not call
Bitmap::cache with a &quot;hole&quot; in the cache.</p><p>The drawings below illustrates the principles:</p><ol><li>Caching allocates on top of the previously allocated bitmaps:</li></ol><div class="figure"><a href="/img/Development/UIDevelopment/TouchGFXEngineFeatures/CachingBitmaps/cache-operations-cache.png" target="_blank"><img src="/img/Development/UIDevelopment/TouchGFXEngineFeatures/CachingBitmaps/cache-operations-cache.png"></a><p>Allocation sequence of bitmaps in memory</p></div><ol start="2"><li>Removal marks the memory unused:</li></ol><div class="figure"><a href="/img/Development/UIDevelopment/TouchGFXEngineFeatures/CachingBitmaps/cache-operations-uncache.png" target="_blank"><img src="/img/Development/UIDevelopment/TouchGFXEngineFeatures/CachingBitmaps/cache-operations-uncache.png"></a><p>Unused memory in cache after removal of cached bitmap</p></div><ol start="3"><li>Allocating the next bitmap compacts the cache and allocates on the top:</li></ol><div class="figure"><a href="/img/Development/UIDevelopment/TouchGFXEngineFeatures/CachingBitmaps/cache-operations-compact.png" target="_blank"><img src="/img/Development/UIDevelopment/TouchGFXEngineFeatures/CachingBitmaps/cache-operations-compact.png"></a><p>cache compaction of unused memory after caching a bitmap</p></div><ol start="4"><li>When you remove the topmost (last allocated) bitmap, the memory is freed immediately along with any free memory just below it:</li></ol><div class="figure"><a href="/img/Development/UIDevelopment/TouchGFXEngineFeatures/CachingBitmaps/cache-operations-uncache-top.png" target="_blank"><img src="/img/Development/UIDevelopment/TouchGFXEngineFeatures/CachingBitmaps/cache-operations-uncache-top.png"></a><p>Topmost bitmap cache removal</p></div><p>The next cache operation will in this case not involve a compact.</p></div></article><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/Development/UIDevelopment/TouchGFXEngineFeatures/CanvasWidgets"><h5 class="pagination-nav__link--sublabel">Previous</h5><h4 class="pagination-nav__link--label">« Canvas Widgets</h4></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/Development/UIDevelopment/TouchGFXEngineFeatures/CustomWidgets"><h5 class="pagination-nav__link--sublabel">Next</h5><h4 class="pagination-nav__link--label">Custom Widgets »</h4></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#setup-the-bitmap-cache" class="contents__link">Setup the Bitmap Cache</a><ul><li><a href="#bitmap-cache-configuration" class="contents__link">Bitmap Cache Configuration</a></li><li><a href="#blockcopy-copies-data-from-flash-to-the-cache" class="contents__link">BlockCopy copies data from flash to the cache</a></li></ul></li><li><a href="#cache-operations" class="contents__link">Cache Operations</a></li><li><a href="#cache-strategies" class="contents__link">Cache Strategies</a><ul><li><a href="#cache-bitmap-on-a-screen-basis" class="contents__link">Cache Bitmap on a Screen basis</a></li><li><a href="#replace-the-background-bitmaps-in-the-cache" class="contents__link">Replace the background Bitmaps in the cache</a></li></ul></li><li><a href="#cache-memory-management" class="contents__link">Cache Memory Management</a></li></ul></div></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="text--center"><div>Copyright © 2020 ST Microelectronics</div></div></div></footer>
</div>

<script src="/styles.8e46bf91.js"></script>

<script src="/runtime~main.8fd45071.js"></script>

<script src="/main.1801c4b7.js"></script>

<script src="/common.fce9659d.js"></script>

<script src="/2.3b43b795.js"></script>

<script src="/3.b0ded709.js"></script>

<script src="/1be78505.4b59c28b.js"></script>

<script src="/20ac7829.338acc89.js"></script>

<script src="/17896441.2aeaded5.js"></script>

<script src="/aa64f3e9.3c02e882.js"></script>


</body>
</html>